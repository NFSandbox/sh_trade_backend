In this wiki page, we will briefly discuss the design of the entities and relation in this system.

# Sub ER Diagrams

![User-Item-Trade ER Diagram](https://github.com/user-attachments/assets/0e8766b6-beb3-4ae0-9b97-a64ad2f2ee07)

The image above illustrates the relationship between `Users` and `Item`.

- A `TradeRecord` has references to two different users, the `seller` and `buyer`.
- `TradeRecord` has a One-To-One relation with a single `Item`. The `status`(`交易状态`) field indicates the current state of the trade which is represented as an `Enum` type in Python and database.

For info about how Python `Enum` works with SQLAlchemy, check out [SQLAlchemy Docs - Using Enum with ORM](https://docs.sqlalchemy.org/en/20/orm/declarative_tables.html#using-python-enum-or-pep-586-literal-types-in-the-type-map)

---

![User-ContactInfo Diagram](https://github.com/user-attachments/assets/190ef8ea-fc56-4345-97f1-daae16532962)

Image above shows sub ER diagram between `User` and `ContactInfo`.

Our system **allows each user to have several contact info entries**. Users could add several personal contact methods like QQ, WeChat, Phone Number and Email.

This feature achieved by creating a new entity `ContactInfo`, Here is breakdown of some of its field:

- `contact_info_type`(`平台`) specifies the type of the info, _(e.g.: `WeChat`)_.
- `contact_info`(`平台ID`) stores the actual contact details with the specified type, _(e.g.: QQ Number for rows with `contact_info_type == 'QQ'`)_

---

![Item-Question ER Diagram](https://github.com/user-attachments/assets/ea63f404-3b29-4e08-aa72-3e855efbbb79)

For each published `Item`, users (especially prospective buyers) often **have questions that aren't adequately addressed in the item description** written by seller.

To accomodate such issue, our system allows any eligible user to ask question about a specific `Item`.

- Any users can ask questions about `Item`.
- Question could be set to public or private. **Public question are visible to any users** including question and answer.
- **Only seller `Item` can reply the question** relavant to the `Item`.

---

![Items-Tags ER Diagram](https://github.com/user-attachments/assets/1f5bcbaf-58ef-4691-8268-94ce89d14625)

Image above describes the item-tag system entities design in this system. Users could add several tags to their published `Item`, while buyers have the ability to categorize their search result or recommendation flow using `Tag` as filter.

There is a very **classical Many-To-Many relation** between `Tag` and `Item` entity, that is:

- An `Item` could have several `Tag` attributes.
- There are several `Item` objects belongs to a single `Tag`.

To achieve such relation, we used one more _association table_ besides two entities with only two fields: `tag_id` and `user_id` with both of them specified as Primary Key.

# Outline & Overall ER Diagrams

![Outline ER Diagram](https://github.com/user-attachments/assets/f14e6098-ca7a-4e60-b89d-03481399ecda)

![Full ER Diagram](https://github.com/user-attachments/assets/9da5fafc-877b-4821-82e9-f6fb7b7a50f0)

> [!note]
> If you are suffering issues caused by low image quality or image load issues, please check out **View ER Diagram DrawIO Project File Online** link in Refs chapter below.

# Refs

- [View ER Diagram DrawIO Project File Online](https://viewer.diagrams.net/?tags=%7B%7D&highlight=0000ff&edit=_blank&layers=1&nav=1&title=ERD.drawio#R7V1hc9s20v41%2FGgPAQIk8FGy5V5vkrlc8960%2BXSj2Iqti225stIk9%2BtfgiJocwFRNEWAWB47ndaibNriPgvsPvvsIkouHn78sl0%2B3b3f3KzuIxrf%2FIiSy4jm%2F3Ca%2F09d%2Bbm%2FQqRk%2Byu32%2FVNee3lwsf1f1flxbi8%2Bm19s3qufeNus7nfrZ%2FqF683j4%2Br613t2nK73Xyvf9uXzX39tz4tb1fGhY%2FXy3vz6u%2Frm93d%2Fqrg8cv1v63Wt3f6N5O4fOdhqb%2B5vPB8t7zZfK9dWv3YXW0ed%2BWf%2BGG1fVg%2Brh53%2BTvvl9uvq23EF3e7nfqks4he5f9%2BUd99frvZ3N6vlk%2Fr5%2FPrzUN%2B%2Bfo5%2F5arL8uH9b16zq9uNC9vlP%2B6ZBElF9vNZrf%2F6uHHxepeGUubYf83XR14t3oOW3XfFj9w%2Bf3zP%2BdfNr%2F%2B59277%2F93nV1lsw%2B%2FnJV3%2BWt5%2F618vhFN7%2FP7zdUnUw9p97N88umf3zb6jbPnAhf5Q4iJeMrBNX95P%2F%2Fqtvj%2FgkezRSQX0YJF88tIJvrW5XOrvnFvjeoX0e3m2%2BPNSv3Zcf7297v1bvXxaXmt3v2eozq%2Fdrd7uM9fkfzL591287WCAi3%2FwBK3RFT3f%2F2g9KdebXerH68ulQ%2Ful9XmYbXb%2Fsy%2FpXw30fAqveaMML6%2F8P0Fg0S7yN0r%2FOkfXJaYuq3u%2FWKq%2FIvSWm%2BwHHNrOcGjeRItMvXf%2Bby15e42D5%2B%2FPQdiNSah1bQ1XluNW6yW9mC1D%2FSP33cXV0%2BPN7%2B9X%2F%2Fr5%2B4fsz9%2Bc%2BtvWZSv5TMRLdJIiGie4fU3yuqWY6nFcK7czWo4i7up9S1Ty1r%2BRY40cWk82Py%2B%2Bba4CuShZi2eaezzmXLHm89lNEuLtezqDc4Qts3ioW2W2v3gKhKpWoBmuR8QXM%2BU06GfaWbxA%2FgEH29mKnjOXz1uHlf1p1Zfv094hs%2Bbb9vr1XGP3S23t6vd8W1udVOL5U2LvHrktm1YX9uu7pe79V%2F1DMBmhvI3fNisi%2FVDR28p8CIJLLn%2F3OVPvQ6hwY0YATdi4Eb7B2PcqEBF9bG7A0WgAQqbgDIkUCQaoKQTUIYEiv71rhISIaOZLALkpAgMsCYkaZvg2WtCQhynknXL%2FXqJM36WSd1uCRk62CPUq8dVuakKzrNoHo%2FEjtngdkwO2vH5afl4oh2ZIt3ypHWRqpRqfvHKavu7o7QaSwa3mlPOIY0kVy62kJHIFO0wCl%2BrgpvhrGZhHQKNZ%2FX%2BcjygDSuizQDjyiEF3jaizQDpzonniBYPm9IeK3TCihOs4CFU2mMlmbDiBCt4OJX2WOETVlxghVpycxXSz6IZK6JEUaghIOsRVvE8oee89hQZt2gevFbPtcth8MGWLkjDCgMZJDZhTN%2FWBTkkNmNnLvjxv3L34a%2Bv239%2F%2Bzi7uznL%2Fjb7NTlLTBe01CXzh%2F5u%2BXl1X0fJ8n59%2B5h%2FfZ1bfbXNLyivWV8v72flGw%2Frmxt1j%2Fl2leeFy8%2FF%2FRSintTHKT4gn0f80oKo4nX5F1gkXM2wh85bqezKPyEqNWAHnTo%2Bj6WUNcPQXnBzBn5i8%2BXL88rN2mrjXQJdA9ruw4EtAjzuaxEA%2BzAT3O8iYO4Xj2gXAY37kxeBs%2FiccJbVLKMr%2B3iWAdf6x0yFa4o9Z0rFqr64KKi9LBI0mkuc1B4VIDDWrwej9qhjERi0Yx5851dSRdGqLxhOOzLJj9pRf4sfM%2BJhaPXKgW1XhqF50ldonrgLze3PFQ9DS9sK3iasnIyVXzb%2FfvfrbTK%2Fff%2Fu09%2FXf%2F3z0%2F3889nhImsPuwNT%2B7ja04tGlXkhYJ1fRBK7aDjJIHVT2d%2FHPm81pOtw7bI026gMSXkWnCGdxmtjkR0xMagHfvryI%2Fu5YvIT%2FfmfT%2F%2Bafbj8ffPJqjJ3qDvKr8wKV0wjEb9B%2BxeWIaEWgg9uRtwlyyZkhhI7gRw5hSFP69jpEHb6j52sjzXIgmVTlIc9yjbE252jbCgnd4wUqwp8cKg0QuA1VpoCzlCgAhYV1rW0PThUbLJz5FAJSwUxnlWFWqDSZ%2FJel1OMJOJMxHFq12%2FEaVW6D%2B7yjZDDHknwvnzeaExz7fOHeZ4euiIyRe%2Fk%2FrBvjxCvx5Ig6oqA%2FefDO7iN0wnUwXE2FlcKilP7RQ1phrt%2BUfvzd8wijWWATZKQc1rfyIXPllG78WyMwDRwpWY4kpqG8zl0xWo4m5441AVamgt040oSzApt2r37Im3ey%2FM6rQESFmLsIj1LjR0DYqhlpYD6RkyICTLLsyPGMjQEBWI4PRc8z9FYRlIhJK9rMGUeM5BEabtiyZJU67QxYslpFpgnfyKazUoKSKn7xpEXEp6cZ3XDycFzQ6s%2Bc%2FBloRF12JYFznoMPeTwzm%2BTgvaWZQhF7OZZIvbJtKaZfHbX2Q3nNLc3DKeI%2B1Qp8PKEcX7xhmkZ4WX7qcWcg2f71KYUcUfVjERyJ7IUmjLzOWvIbsrDxE0P8RQvZLCJNlyMM3qyGE74HDdkNZz%2BA1yVQ6APQlPW9JPIjelzCpHdmEFyKo1b%2BdFQWG8SgYTCqZm7krhrLTQ1KT3puRya2BJh7JCRYUGGWCDTtd0lNTm9fI3xjJkgW%2BlOw4zeByfMOMJMkC11jfTA8XUmLJYGM2bsLLq5Nz2YoAluOEIz%2FnsZjiD08JiehiOA2%2FQ6HMH%2BOIJsEjltOQiMtB3fcmDW%2FzAMTGrGfx8Dk0R9XtIZPQ0%2FHrzfqcynmJuhJmlkSu8jWw%2FQCI%2B1pWA6EaE2os8rZ8sO80W9KLTmpDiPsRDIz5AytBRInO1nMXplhphNn9XjVHFxpYb4v7ieKBocONbuaEKh4w2usGPUpQXH0tZuGm7w0ghzOiGk8rjcfFT1Ge2dMf8398H5FdrjNAxDJmxwQzqdEGKuoSMZBEZA2pAMrhhiNsVQbzWvottvdlWea1PKzXk0u9AyAqTly2o4QECGxEMq6gDsOBEdWvECWJ3BSeXtKQSIH6gTckxBMzyckw72JrQMh5Ygh5M0RpgTWgZDC3eanRmxIU5JKTQSTYcWlPIgW0oaffeok2sohuLkCYj%2FeddpVSmYO0GMqe%2BuCxBmuPmnCRccBQje27B2NatdK250z%2FdpyHFfgOCHM0AXowbRFiDgocIBFCC40%2BaNsfCgEq66ZHClMfc83nMsxwpDQw6uMuaH2zamc4UPma0yx3Bmc1p0H8vBwpCs9nkau9VsOvdBkKLoqOp4ilLu4YGkKJnBbGcdUxQRwztRvzxEimcOS3u0hKWrGxNabKwVdrSE1S80JrTgIcvaoyUsRnxMaMHTWNYeLTQotBgVeYMob02tMngnCVoBXFOrZk6JVttdIb8PbTcFGYkeGxout5pOx7j0knkOLlxM8eglWq%2FgaVi5BIMC%2F84VcA5XcN8V8NQxvTSLFbG07%2BmYt6%2BAB1dSobCKmVGLo3stqeiVxtUMELhiNxizkeINTc4ADUmGljNkh7s8ehG2ArOpgUqkGJTFVdMO1qmG4KRikg6ua81svIy7tXQkSnNox2zwkkvmtPXDtONISp7AjsK2Qfq1o9POj2JabJ7DKDdclJnMKPwRnC6YDl5Ly2yyn8EzmhOPpiyxGUhGkwlRMzqHtGPbhEZyVr%2BRFPUbOc5nMqc6o%2FH6PNRoDq47ykZIY2SBFdAhjZEkXb1eF5kq%2FMSe3d5128fqx3r3h3r3PE2S8vWn4nWcZuXryx%2Fljxcvfr568WG1XecfUdHcxbUem0hYS%2BwFVgQxmkio6Ig9o4mEQhQ7xp7%2BwxGsVAxpyYyB8IQkMumGFnh2Nkm0CN4XWpySPcV43tnVganohyIVRKyPZYCvHJwwEDbiJ8wVoPVkTY3TQFaANDk8uPntHUnmvTyfZSHwyCw0O328SBeWKIdDol90blOFszAyz0U6ESQB0giC47lQWBHGmNCCZ85z1rYFflpbnKEFzzAWXfCe0OIDLXbBn8mzfDXhgkPwJ3qd7SxFnQKjp0HHveBPOD7GaTzN1MEpf4SN7ZyaqY8VNfjg2kydsU7N1CcZMh28OiWdsngjbaZOB%2B%2BBl9Sl%2F420mXp4QZbE08Kmo6rj%2FGpYOUrGDsm33pqjZIagDzbDOc5oJR5utTVa9Mo5oaV3tODhVtujJazazZjQgodbbY8WOqHFEVqmnso%2BAlAxuAJZ4hEjtnf7wHoqYYOd6NoVzw%2Fix5fb45lB3Rotlb8FApdMAsVp1lU%2FKDm4k9AyXU9wqR7tpFk%2FbZsYnN4lMZ45Xq2LqSKwyUyiN8eHonUhnDm%2BtZhqOWIK7fSUF%2Bj3UU2NRZbVbENPw477aiqJ6cFF3EE3fq0mh6kmAEsCgzeJkhgPuVyBDJsChmjepFq0u54mYLaL6zDA06J9uPDXS0o%2Fv4hkWur450gPUgXT570eAWi1mW1pHtzDm9D12r%2FtfcZBuTecYtS5e5iDjkTmjrCzy9sm5z7m3MQ8Uj4b3MFdV%2Fzyx7X9uW%2F%2FzD97%2BfpT%2Be3Fi5fez%2BKVbv7sb2Voq5QmYdF6PDPg0l39Sk3oeda%2FOj2AhkVzWehHuDosTBE0xYmkgr0oglAuGVzS87rZEp%2BSEqshnY6J4Epzt1%2FpR2XIFEwn5j5HblnNGGTzgjVio5bQrmmJCWX9BsOKeedZxRA77ooy1scaZAXvNKSENU2EkzqdymAZpf02T%2Bs3iv1m%2BF7F9Xj7ImgMZ9dqO%2Fnoi7Bnz5ZCmtpxZ9GMlSe867JhsPNJiTGVJ7Zssq7mk9ofq2POS7JoJgrRinhDaBSeR5AqHgrHI2zU13TAMVjIaN1s1tMy%2FXqcUyJKW2s%2FgVS2rv%2BH53HGHpTYWkz8etzhzHKayn3YkLBoEMCu51S8OaLJ%2BMZ5NsPvek5bm43RWih3PcLB3DzrUad%2BPc5p5mWdiJYqyjVfTOcXb%2BjXC88Hjchz%2BH2Q2pKGwQmXxvzmKOGiH2AgjAvJYPTTte5qJJ3Uc%2BFVjzFFJoVrRn4PB4mRNK0L4chpyOlVCGf%2F9LaMM1C%2Ft0hgmxjBye17d3szWXpE6%2FYa%2BL2ME%2BJJnU1Pgvf7IGWUTe58fLsPq8AyIr%2FXT2QU270Gfg%2FbfRLzulA2fLcPcthCozsf9%2FuwJFRj8nszKcQwPrAZ%2BX2cF1wNdgzY04MclNHI%2Fx339LB01AF4em6%2B5c9X31b6zuE%2FOYVtmOUvfkHf%2Fpb95g0mFvHGD%2Fqz9NI4R1k9gKDBLytBTlRp5KePLythtcwGsKz05vhmieABreNr5PfBEyaAL9AdQgE7fpDa3UYVzUQUDub3Jljwbvi9zh1ntO734TMGQSqxG2VYxzd8Ojm%2BI8c30fInWsfXn6WPDT%2FLwJF4oft94rR3jisZ1Qx9cy1PzsFxA9UYtMF6rBLHvXKqMy4thHB4ZxZaDCeJRQbn1XD6EM9Jt3%2FEeAyop6Rt4KRX9RS3VFOVq2RK9lsd6xC4TyRxi8fq1yNs1appD2o2mxi8WZtbQgfLxoHrsUqf4wrtjxUP9aod93j3dGCZGJxoI%2BFBs60zMUbpuSRp9Y99afVVyMVD3vG2SfyYoQPu5HlmGsdD%2Beit5n8aLU0Lje%2BBO1M3fstOSJjDDN6FpZEynVLYGBdKnoHpSF4P3LKbznHH%2FzjPKaQxaGINwJCHKaDpnEJtNiKCM5vT%2Fv9xnFNomE36PF7SbjY8YmgdVx0fMhVWzyONk7rVSdx1nKQZMnmObVM8itr2cAlLUTsquCCi61rDJawselRwQUTRtYZLMsHFFVwsHB2%2B2XkUThq20iBep5qkNgYrUD%2Bkbf0wNIE7GEEkux4vkucUB4qfntxQMwhjELpWyO%2BjQ07qUxX7aWzRClrwE%2B7kbxmeeTjtt%2BPQlgFYA%2Bm%2BDMDd2HPFLKMGWtAOxsgO7ePdBmOw%2BkCcsxMbZ%2F0vBE65Pa4ovTxoU5Q6K4Z85l9cFGxfFgmqxp2hZPsINwZE6th7uMMHHKvJoCXHcW4ryeBJzzZL6mPe%2FBgSDxGXtVWzBLc3gxBd9BaiZ75DdDw8nF6hJrQMhxanY4TNI6PGcspcCpkcYZsI7Xe%2FdzpW2Dw0aiSmzCP28EzpVVaGVpuUZeF5oc7MfWmT8iuzwh3TSOBtUFNkiH0fHM6QI2TENDiDiaOMrBmas30gReGtYEzm%2BgQ3kxMLFS866MMfd8u%2B4m4B9eiu0YJnHm3adlxdFhpawOpidCHhQQse5V57tIQ2jWg8a4vrY6DroouRhKAkzVoQv55jUDxcnmjbmRZ6TCF783ujx8213x%2Fm8no52222UP69b6sQr8%2BVQtRNYfS5h%2BDlePpPRdvMIbT%2BUzhyrHv%2FKVRxGHGCay93yg3mzi3Udq5290W5qY%2BirCuDa8fRfwACt29PMIUV1NMYjKGTcD5gawE01WeAVfuGnv3nye%2Bl46bXURRz4O6eDe%2FlFI2Xa4Sh29wF6HPo7OWmsBJOJnXt5E7Vd2Y5XhRTqthLrzROtxcivEKgdC2%2FA%2BX4sZhSBpefSTz6u9bsqwyrVY0IBs3enayHMnvPrWoSD2nXHi4sMLjE9fMkpD6t4s1okXo4etVR5beVQp4uwEvihm1iTgrSTkYiiWZi8VshHcn3h0Xb%2FSFfuHdRxw4O245SR%2FeRjo037x%2BM1OMAahvqKizqbWcNlvJ0WV6jgYWI5GUx4%2BYymvHRG5hICWO9Mzq0jQlxKqMt5heJrODgL99g2QDnwDGjB27oOXCEHHbQXsomULHXYM3GQkpYzeyGYk%2FaMi6vreyEHKbGe7CkYTdFmhGVbCnbLtCWxGgKdDKi9ehn7sqSekX3tJ6OpMhhWLKqcg2WOxPqlLY2LTmSWY3Qki%2F58ICmpBZThpnYkvaHYQZ2nDY1mZCuzWXUYEI8N5cRikflWuGgxWlqYanox4UYPErXamub1phBEYOHna9STXyIkYZsrjNiJBRcekeMSdB%2FNSGDY3oN6fV8diJFnVenp6HH%2FbgaYj2v1Rl7U2uVRZ3jB5BO4Jk8WKEM38LN9HyrU9taKBxxJKnfShnRQgBngOkOkNYCySoECAUfcQqs2hkfFW0%2FUPsDGdMp7C9g72E6ZUJi0NoU%2FLaeOKUNC5Z3tihpQ9ma7g2woBYb0rccOoPX1BLq0nyp0ijL%2BJUdRdF5yNFOMpGQ7mXDx2eJUy3qWIbQ5A4I5wcFYTyn6tPK73ITUtUGvHfJ%2FN%2FcE%2BdXeMsulBiraQjGdNrQba6m46iGkipB0aYkg59pTBKbOLRHiYIsZOD7Kmh51jePZheFEvBCbZI46QsKCesQTInnBJMqHjuen%2BrAO5T8NDEmLZK0M%2FXMzOWd%2B2afEzzd3lUIOMFmeNggYkt18DnBZnDY6H3TU%2BjYlkcJS8oam1YnqYVD8atmZXgGUFZ%2BfNzjNSCD8XgzfU87U%2BC29FF4rpIwk3r708QNEhacHXLmDiw44briWNqGnYYgDyw4w6Ofa18BC20FoMYUaUIkcNo3jAk5fjPnK4DJ%2FeGtg1Uu0McpbTQBnWPhF8IYInmbfroI1wBz467Ob3%2F7GmAJJxPfcT%2BeJvSKE8UHm1jG0NJUT1Z4u34iMWBDdcTiDTZOzxARqv9RsqJxLlGNcyjTxdy3IBmtLwyYLDqdCmgYTlUaUjVNqKwrXOFVUOSYB%2BaktqFhfvUT3CltkxVH9u2rtkKNChrN%2BDd4CAQbfAwU4YeVTD1U%2FHgx0ivRhkNa38uj%2FAANZxIpvSrLoQ9CU2LVmhMO98cQjImHSan28uPxMA8rHiacQfaz85hlLqGq0fOc5fzDjBIyYVXcCOcQMp2PgEqhypnB0p1zyCAia94AGTpBxh1kEBE1rHUXlAbXBBkXkDGFZw8mZpDw%2BxX%2Be%2BlfFboQrQl%2Bfhp%2BwG088P0ckTys9Xow4h2Eg5KShGUD56uByfzhrfZV6O%2Bj2qcPo6jGRJ4GHg%2FOrxNnV1yRuCrU4VY695DiHxPzkIpDe%2FNwzEOKSMbVPidIQ2MeDpL4bw%2FwIBdJfTcyp%2FTgMtDLyGB5pc5wVE5%2FEc0uxj8yGJ7qkdoaZHsaGJy%2F3G7UE39BRP4Z795vbtTmu%2Fh%2F) _(Notice: You can zoom-in or zoom-out the digram online when accessing through this link)_
- [Full ER Diagram PNG](https://github.com/user-attachments/assets/c71fac68-3cda-4932-938d-15cd8b1d3bcc)
- [ORM Class Code](https://github.com/NFSandbox/sh_trade_backend/blob/main/schemes/sql.py)